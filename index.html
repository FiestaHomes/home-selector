<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fiesta Homes Selector</title>
<style>
body { font-family: Arial, sans-serif; background: #f4f4f4; margin:0; padding:20px; }
h1 { text-align: center; color: #2b2b2b; }
.filter-section, .results { background: white; border-radius: 10px; padding: 20px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); max-width: 800px; margin: 20px auto; }
label { display: block; margin: 10px 0 5px; font-weight: bold; }
select, input, button { width: 100%; padding: 10px; border-radius: 8px; border: 1px solid #ccc; font-size:16px; }
button { background: #0066cc; color:white; border:none; cursor:pointer; margin-top: 15px; }
button:hover { background: #004c99; }
.home-card { background: #fafafa; border-radius: 8px; padding: 15px; margin-bottom: 15px; border: 1px solid #ddd; }
.home-card h3 { margin: 0; color: #333; }
.home-card p { margin: 5px 0; }
.contact-btn { display:inline-block; margin-top:10px; padding:8px 12px; background:#0066cc; color:white; border-radius:6px; text-decoration:none; }
.contact-btn:hover { background:#004c99; }
.slider-container { margin-bottom: 15px; }
.slider-label { display:flex; justify-content:space-between; }
</style>
</head>
<body>

<h1>üè° Fiesta Homes Selector</h1>

<div class="filter-section">
<label>Bedrooms (exact):</label>
<select id="bedrooms">
<option value="">Any</option>
<option value="2">2</option>
<option value="3">3</option>
<option value="4">4</option>
<option value="5">5</option>
</select>

<label>Bathrooms (exact):</label>
<select id="bathrooms">
<option value="">Any</option>
<option value="1">1</option>
<option value="2">2</option>
<option value="3">3</option>
</select>

<div class="slider-container">
  <label class="slider-label">
    <span>Payment Range ($):</span>
    <span id="payment-display">1000 - 2000</span>
  </label>
  <input type="range" id="payment-min" min="0" max="5000" value="1000" step="50">
  <input type="range" id="payment-max" min="0" max="5000" value="2000" step="50">
</div>

<button onclick="filterHomes()">Find Homes</button>
</div>

<div class="results" id="results">
<p>Use the filters above to see matching homes.</p>
</div>

<script>
let homes = [];

// Load homes from JSON
fetch('homes.json')
  .then(response => response.json())
  .then(data => {
    homes = data;
    filterHomes(); // Show all homes initially
  })
  .catch(err => console.error("Error loading homes.json:", err));

// Slider display update
const paymentMin = document.getElementById("payment-min");
const paymentMax = document.getElementById("payment-max");
const paymentDisplay = document.getElementById("payment-display");

function updatePaymentDisplay() {
  let minVal = parseInt(paymentMin.value);
  let maxVal = parseInt(paymentMax.value);
  if(minVal > maxVal) [minVal, maxVal] = [maxVal, minVal];
  paymentDisplay.textContent = `${minVal} - ${maxVal}`;
}

paymentMin.addEventListener("input", updatePaymentDisplay);
paymentMax.addEventListener("input", updatePaymentDisplay);

function filterHomes() {
  const beds = document.getElementById("bedrooms").value;
  const baths = document.getElementById("bathrooms").value;
  let minPayment = parseInt(paymentMin.value);
  let maxPayment = parseInt(paymentMax.value);
  if(minPayment > maxPayment) [minPayment, maxPayment] = [maxPayment, minPayment];

  const filtered = homes.filter(h => {
    // Bedrooms filter (exact)
    let matchBeds = !beds || h.bedrooms === parseInt(beds);
    // Bathrooms filter (exact)
    let matchBaths = !baths || h.bathrooms === parseInt(baths);

    // STRICT Payment filter: home must be fully within the selected range
    const [homeMin, homeMax] = h.payment.split("-").map(x => parseInt(x.replace(/[$,]/g,'').trim()));
    let matchPayment = homeMin >= minPayment && homeMax <= maxPayment;

    return matchBeds && matchBaths && matchPayment;
  });

  filtered.sort((a,b)=>a.price-b.price);

  const resultsDiv = document.getElementById("results");
  resultsDiv.innerHTML = "";

  if(filtered.length === 0){
    resultsDiv.innerHTML = "<p>No homes found. Try adjusting your filters.</p>";
    return;
  }

  filtered.forEach(h => {
    const card = document.createElement("div");
    card.className = "home-card";
    card.innerHTML = `
      <h3>Home #${h.number}</h3>
      <p><strong>B-B:</strong> ${h.bedrooms}-${h.bathrooms}</p>
      <p><strong>Payment:</strong> ${h.payment}</p>
      <p><strong>Price:</strong> $${h.price.toLocaleString()}</p>
      <a href="tel:4322257519" class="contact-btn">Contact for Info</a>
    `;
    resultsDiv.appendChild(card);
  });
}

updatePaymentDisplay();
</script>

</body>
</html>
