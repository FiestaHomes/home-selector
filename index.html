<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fiesta Homes Selector</title>
<style>
body { font-family: Arial, sans-serif; background: #f4f4f4; margin:0; padding:20px; }
h1 { text-align: center; color: #2b2b2b; }
.filter-section, .results { background: white; border-radius: 10px; padding: 20px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); max-width: 800px; margin: 20px auto; }
label { display: block; margin: 10px 0 5px; font-weight: bold; }
select, input, button { width: 100%; padding: 10px; border-radius: 8px; border: 1px solid #ccc; font-size:16px; }
button { background: #0066cc; color:white; border:none; cursor:pointer; margin-top: 15px; }
button:hover { background: #004c99; }
.home-card { background: #fafafa; border-radius: 8px; padding: 15px; margin-bottom: 15px; border: 1px solid #ddd; }
.home-card h3 { margin: 0; color: #333; }
.home-card p { margin: 5px 0; }
.contact-btn { display:inline-block; margin-top:10px; padding:8px 12px; background:#0066cc; color:white; border-radius:6px; text-decoration:none; }
.contact-btn:hover { background:#004c99; }
.slider-container { margin-bottom: 15px; }
.slider-label { display:flex; justify-content:space-between; }
.checkbox-container { margin: 15px 0; }
.checkbox-container label { display:inline-block; margin-right:15px; font-weight: normal; }
</style>
</head>
<body>

<h1>üè° Fiesta Homes Selector</h1>

<div class="filter-section">
  <label>Bedrooms (exact):</label>
  <select id="bedrooms">
    <option value="">Any</option>
    <option value="2">2</option>
    <option value="3">3</option>
    <option value="4">4</option>
    <option value="5">5</option>
  </select>

  <label>Bathrooms (exact):</label>
  <select id="bathrooms">
    <option value="">Any</option>
    <option value="1">1</option>
    <option value="2">2</option>
    <option value="3">3</option>
  </select>

  <div class="slider-container">
    <label class="slider-label">
      <span>Payment Range ($):</span>
      <span id="payment-display">1000 - 2000</span>
    </label>
    <input type="range" id="payment-min" min="0" max="5000" value="1000" step="50">
    <input type="range" id="payment-max" min="0" max="5000" value="2000" step="50">
  </div>

  <div class="checkbox-container">
    <label><input type="radio" name="placement" id="park" value="400" onchange="filterHomes()"> Park (+$400)</label>
    <label><input type="radio" name="placement" id="land" value="800" onchange="filterHomes()"> Land (+$800)</label>
    <label><input type="checkbox" id="taxes" value="300" onchange="filterHomes()"> Property Taxes & Insurance (+$300)</label>
  </div>

  <button onclick="filterHomes()">Find Homes</button>
  <button onclick="resetFilters()">Reset</button>
</div>

<div class="results" id="results">
<p>Use the filters above to see matching homes.</p>
</div>

<script>
let homes = [];

// Load homes from JSON
fetch('homes.json')
  .then(response => response.json())
  .then(data => {
    homes = data;
    filterHomes(); // Show all homes initially
  })
  .catch(err => console.error("Error loading homes.json:", err));

// Slider display update (unchanged by checkboxes)
const paymentMin = document.getElementById("payment-min");
const paymentMax = document.getElementById("payment-max");
const paymentDisplay = document.getElementById("payment-display");

function updatePaymentDisplay() {
  let minVal = parseInt(paymentMin.value);
  let maxVal = parseInt(paymentMax.value);
  if(minVal > maxVal) [minVal, maxVal] = [maxVal, minVal];
  paymentDisplay.textContent = `${minVal} - ${maxVal}`;
}

paymentMin.addEventListener("input", updatePaymentDisplay);
paymentMax.addEventListener("input", updatePaymentDisplay);

function filterHomes() {
  const beds = document.getElementById("bedrooms").value;
  const baths = document.getElementById("bathrooms").value;
  let minPayment = parseInt(paymentMin.value);
  let maxPayment = parseInt(paymentMax.value);
  if(minPayment > maxPayment) [minPayment, maxPayment] = [maxPayment, minPayment];

  // Add-ons
  const parkAdd = document.getElementById("park").checked ? 400 : 0;
  const landAdd = document.getElementById("land").checked ? 800 : 0;
  const taxesAdd = document.getElementById("taxes").checked ? 300 : 0;

  const filtered = homes.filter(h => {
    const matchBeds = !beds || h.bedrooms === parseInt(beds);
    const matchBaths = !baths || h.bathrooms === parseInt(baths);

    // Strict filter: home base payment only (ignore add-ons here)
    const [homeMin, homeMax] = h.payment.split("-").map(x => parseInt(x.replace(/[$,]/g,'').trim()));
    const matchPayment = homeMin >= minPayment && homeMax <= maxPayment;

    return matchBeds && matchBaths && matchPayment;
  });

  filtered.sort((a,b)=>a.price-b.price);

  const resultsDiv = document.getElementById("results");
  resultsDiv.innerHTML = "";

  if(filtered.length === 0){
    resultsDiv.innerHTML = "<p>No homes found. Try adjusting your filters.</p>";
    return;
  }

  filtered.forEach(h => {
    const homeMin = parseInt(h.payment.split("-")[0].replace(/[$,]/g,''));
    const homeMax = parseInt(h.payment.split("-")[1].replace(/[$,]/g,''));
    const totalMin = homeMin + parkAdd + landAdd + taxesAdd;
    const totalMax = homeMax + parkAdd + landAdd + taxesAdd;

    const card = document.createElement("div");
    card.className = "home-card";
    card.innerHTML = `
      <h3>Home #${h.number}</h3>
      <p><strong>B-B:</strong> ${h.bedrooms}-${h.bathrooms}</p>
      <p><strong>Payment:</strong> $${totalMin} - $${totalMax}</p>
      <p><strong>Price:</strong> $${h.price.toLocaleString()}</p>
      <a href="tel:4322257519" class="contact-btn">Contact for Info</a>
    `;
    resultsDiv.appendChild(card);
  });
}

function resetFilters() {
  document.getElementById("bedrooms").value = '';
  document.getElementById("bathrooms").value = '';
  paymentMin.value = 1000;
  paymentMax.value = 2000;
  updatePaymentDisplay();
  document.getElementById("park").checked = false;
  document.getElementById("land").checked = false;
  document.getElementById("taxes").checked = false;
  filterHomes();
}

updatePaymentDisplay();
</script>

</body>
</html>
